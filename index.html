<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CCKC POS PRO - Light Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;700;800&family=Sarabun:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4f46e5;
            --bg-main: #f8fafc;
        }
        body { 
            font-family: 'Plus Jakarta Sans', 'Sarabun', sans-serif; 
            background-color: var(--bg-main);
            color: #1e293b;
            min-height: 100vh;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
        }
        .pos-grid-btn {
            transition: all 0.2s ease;
            background: white;
            border: 1px solid #e2e8f0;
        }
        .pos-grid-btn:hover {
            border-color: var(--primary);
            box-shadow: 0 10px 15px -3px rgba(79, 70, 229, 0.1);
        }
        .pos-grid-btn:active { transform: scale(0.95); }
        
        .big-total-text {
            font-size: clamp(3rem, 5vw, 4.5rem); 
            font-weight: 800;
            color: #1e293b;
            letter-spacing: -2px;
        }
        .tab-active {
            color: var(--primary) !important;
            background: white !important;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        @media print {
            .no-print { display: none !important; }
            #receipt-for-pc { display: block !important; position: absolute; top: 0; left: 0; width: 100%; }
        }
    </style>
</head>
<body class="text-slate-800">

    <div id="app-container" class="no-print min-h-screen flex flex-col">
        
        <header class="w-full py-4 px-6 bg-white border-b border-slate-200 sticky top-0 z-50">
            <div class="max-w-7xl mx-auto flex flex-wrap justify-between items-center gap-4">
                <div class="flex items-center gap-3">
                    <h1 class="text-2xl font-black tracking-tighter text-slate-900">CCKC <span class="text-indigo-600">POS</span></h1>
                    <div class="hidden sm:block h-6 w-[1px] bg-slate-200"></div>
                    <div class="flex flex-col">
                        <span id="nextReceiptNo" class="text-[10px] font-mono text-slate-500 bg-slate-100 px-2 py-0.5 rounded">---</span>
                        <span id="todayDateLabel" class="text-[8px] text-indigo-500 font-bold ml-1 mt-1 uppercase">Loading...</span>
                    </div>
                </div>
                
                <nav class="flex p-1 bg-slate-100 rounded-2xl">
                    <button id="saleTab" class="px-6 py-2 rounded-xl text-xs font-black transition-all tab-active">üõçÔ∏è ‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
                    <button id="historyTab" class="px-6 py-2 rounded-xl text-xs font-bold text-slate-500">üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
                </nav>
            </div>
        </header>

        <main class="flex-1 w-full max-w-7xl mx-auto p-4 sm:p-6">
            
            <div id="saleForm" class="grid grid-cols-1 lg:grid-cols-12 gap-6 animate-in fade-in duration-500">
                <div class="lg:col-span-7 xl:col-span-8 space-y-6">
                    <h2 class="text-xs font-black text-slate-400 uppercase tracking-widest px-2">‡πÄ‡∏°‡∏ô‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                    <div id="product-grid" class="grid grid-cols-2 sm:grid-cols-3 xl:grid-cols-4 gap-4"></div>
                </div>

                <div class="lg:col-span-5 xl:col-span-4">
                    <div class="sticky top-24 space-y-4">
                        <div id="cartSection" class="hidden glass-card rounded-[2rem] p-5">
                            <div class="flex justify-between items-center mb-4">
                                <h4 class="text-xs font-black text-indigo-600 uppercase tracking-widest">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h4>
                                <button type="button" id="clearCart" class="text-[10px] text-red-500 font-bold hover:underline">‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                            </div>
                            <div id="cartItems" class="space-y-2 max-h-[30vh] overflow-y-auto pr-2 hide-scrollbar"></div>
                        </div>

                        <div class="glass-card rounded-[2.5rem] p-6 sm:p-8 relative overflow-hidden bg-white border-t-8 border-indigo-600">
                            <div class="text-center mb-6">
                                <span class="text-[10px] text-slate-400 font-black uppercase tracking-[0.3em]">‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                                <div class="flex items-baseline justify-center">
                                    <span id="totalAmount" class="big-total-text leading-none">0</span>
                                    <span class="text-xl font-black text-slate-400 ml-2">THB</span>
                                </div>
                            </div>

                            <div class="grid grid-cols-2 gap-3 mb-6">
                                <button id="discountBtn" class="p-4 rounded-2xl bg-slate-50 border border-slate-100 flex flex-col items-center hover:bg-slate-100 transition-colors">
                                    <span class="text-[9px] font-black text-pink-500 uppercase mb-1">‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</span>
                                    <span class="text-lg font-bold"><span id="discountText">0</span> ‡∏ø</span>
                                </button>
                                <button id="depositBtn" class="p-4 rounded-2xl bg-slate-50 border border-slate-100 flex flex-col items-center hover:bg-slate-100 transition-colors">
                                    <span class="text-[9px] font-black text-amber-600 uppercase mb-1">‡∏°‡∏±‡∏î‡∏à‡∏≥</span>
                                    <span class="text-lg font-bold"><span id="depositText">0</span> ‡∏ø</span>
                                </button>
                            </div>

                            <button id="receivedBtn" class="w-full p-5 mb-4 rounded-2xl bg-indigo-50 border-2 border-dashed border-indigo-200 group hover:border-indigo-400 transition-all">
                                <span class="block text-[9px] font-black text-indigo-400 uppercase mb-1">Cash Received</span>
                                <div id="receivedText" class="text-2xl font-black text-indigo-600 group-hover:scale-105 transition-transform">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</div>
                            </button>

                            <div id="changeDisplay" class="hidden mb-6">
                                <div class="flex justify-between items-center px-6 py-4 bg-emerald-50 border border-emerald-100 rounded-2xl">
                                    <span class="text-xs font-black text-emerald-600 uppercase">‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏ô</span>
                                    <span id="changeAmount" class="text-3xl font-black text-emerald-600">0.-</span>
                                </div>
                            </div>

                            <button type="button" id="submitOrder" class="w-full py-5 rounded-2xl bg-slate-900 text-white font-black text-xl shadow-xl hover:bg-indigo-600 active:scale-95 transition-all">
                                CONFIRM & PRINT
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="historyView" class="hidden max-w-4xl mx-auto animate-in fade-in slide-in-from-bottom-4 duration-500">
                <div class="flex items-center justify-between mb-8 px-2">
                    <h3 class="text-2xl font-black text-slate-900">History <span class="text-indigo-600 text-sm ml-2 bg-indigo-50 px-3 py-1 rounded-full uppercase">Today</span></h3>
                    <button id="resetDailyData" class="text-[10px] text-red-500 font-bold border border-red-200 px-4 py-2 rounded-xl hover:bg-red-50 transition-all">‡∏•‡πâ‡∏≤‡∏á‡∏¢‡∏≠‡∏î‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
                </div>
                <div id="salesHistory" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                <div id="noHistory" class="text-center py-32 bg-white rounded-[3rem] border border-slate-100">
                    <div class="text-5xl mb-4 opacity-20">üìÇ</div>
                    <p class="text-slate-400 font-bold uppercase tracking-widest text-xs">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</p>
                </div>
            </div>
        </main>
    </div>
    
    <div id="receipt-for-pc" class="hidden"></div>

<script>
// (‡∏™‡πà‡∏ß‡∏ô JavaScript ‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°‡∏ï‡∏≤‡∏° Logic ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡πÅ‡∏ï‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏µ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏ï‡∏≠‡∏ô Render Product)

const sounds = {
    click: new Audio('https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3'),
    success: new Audio('https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3'),
    pop: new Audio('https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3'),
    trash: new Audio('https://assets.mixkit.co/active_storage/sfx/2205/2205-preview.mp3')
};
function playSound(type) { if (sounds[type]) { sounds[type].currentTime = 0; sounds[type].play().catch(() => {}); } }

const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzHrURcZX9VNb1_Lic7BAxtBKGpTYwdLFDO8urZvWaEsRcSmgrgNvTANgc9QxXROyX6/exec';
const products = [
    { id: 'yum_mee_50', name: '‡∏¢‡∏≥‡∏´‡∏°‡∏µ‡πà‡πÑ‡∏Å‡πà‡∏â‡∏µ‡∏Å (50)', price: 50, emoji: 'üçú', color: 'bg-orange-500' },
    { id: 'yum_mee_30', name: '‡∏¢‡∏≥‡∏´‡∏°‡∏µ‡πà‡πÑ‡∏Å‡πà‡∏â‡∏µ‡∏Å (30)', price: 30, emoji: 'ü•£', color: 'bg-amber-500' },
    { id: 'pork_crackling', name: '‡∏ô‡πâ‡∏≥‡∏û‡∏£‡∏¥‡∏Å‡∏Å‡∏≤‡∏Å‡∏´‡∏°‡∏π', price: 15, emoji: 'üå∂Ô∏è', color: 'bg-red-500' },
    { id: 'extra_chicken', name: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏Å‡πà‡∏â‡∏µ‡∏Å', price: 10, emoji: 'üçó', color: 'bg-yellow-600' },
    { id: 'extra_noodle', name: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏°‡∏µ‡πà‡∏Ç‡∏≤‡∏ß', price: 10, emoji: 'üçù', color: 'bg-blue-500' }
];

let salesData = [];
let cart = [];
let discountAmount = 0;
let depositAmount = 0;
let receivedAmount = 0;

function checkDailyReset() {
    const today = new Date().toDateString();
    const lastSavedDate = localStorage.getItem('lastAccessDate');
    salesData = JSON.parse(localStorage.getItem('salesData')) || [];
    if (lastSavedDate !== today) {
        salesData = []; 
        localStorage.setItem('salesData', JSON.stringify(salesData));
        localStorage.setItem('lastAccessDate', today);
    }
    document.getElementById('todayDateLabel').textContent = new Date().toLocaleDateString('th-TH', { day:'2-digit', month:'short', year:'2-digit' });
}

document.addEventListener('DOMContentLoaded', () => {
    checkDailyReset();
    renderProducts();
    updateReceiptNoDisplay();
    updateCartDisplay();
});

function renderProducts() {
    const grid = document.getElementById('product-grid');
    grid.innerHTML = products.map(p => `
        <button type="button" onclick="handleProductClick('${p.id}')" class="pos-grid-btn p-6 rounded-[2rem] text-center relative overflow-hidden">
            <div class="text-4xl mb-3">${p.emoji}</div>
            <div class="font-bold text-slate-800 text-[11px] sm:text-xs mb-1 uppercase h-8 flex items-center justify-center leading-tight px-2">${p.name}</div>
            <div class="text-xl text-indigo-600 font-black">${p.price}.-</div>
        </button>
    `).join('');
}

function updateReceiptNoDisplay() {
    const now = new Date();
    const d = String(now.getDate()).padStart(2, '0'), m = String(now.getMonth() + 1).padStart(2, '0'), y = String(now.getFullYear() + 543).slice(-2);
    const hh = String(now.getHours()).padStart(2, '0'), mm = String(now.getMinutes()).padStart(2, '0');
    const seq = (salesData.length + 1).toString().padStart(3, '0');
    const billId = `${d}${m}${y}-${hh}${mm}-${seq}`;
    document.getElementById('nextReceiptNo').textContent = billId;
    return billId;
}

function handleProductClick(id) {
    playSound('pop');
    const product = products.find(p => p.id === id);
    showGeneralNumpad(`‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${product.name}`, '1', (val) => {
        const qty = parseInt(val);
        if (qty > 0) {
            const existing = cart.find(i => i.product === product.name);
            if (existing) existing.quantity += qty;
            else cart.push({ id: Date.now(), product: product.name, price: product.price, emoji: product.emoji, quantity: qty });
            updateCartDisplay();
        }
    });
}

function updateCartDisplay() {
    const subtotal = cart.reduce((sum, i) => sum + (i.price * i.quantity), 0);
    const netTotal = Math.max(0, subtotal - discountAmount);
    document.getElementById('totalAmount').textContent = netTotal.toLocaleString();
    document.getElementById('discountText').textContent = discountAmount.toLocaleString();
    document.getElementById('depositText').textContent = depositAmount.toLocaleString();
    const cartSec = document.getElementById('cartSection');
    const cartList = document.getElementById('cartItems');
    if (cart.length === 0) { cartSec.classList.add('hidden'); } 
    else {
        cartSec.classList.remove('hidden');
        cartList.innerHTML = cart.map(item => `
            <div class="flex items-center justify-between bg-slate-50 p-4 rounded-2xl border border-slate-100">
                <div class="flex items-center gap-3">
                    <span class="text-lg">${item.emoji}</span>
                    <div class="text-[12px] font-bold text-slate-700">${item.product} <span class="text-indigo-500 font-black ml-1">x${item.quantity}</span></div>
                </div>
                <span class="text-slate-900 font-black text-sm">${(item.price * item.quantity).toLocaleString()}.-</span>
            </div>
        `).join('');
    }
    calculateChange();
}

function calculateChange() {
    const subtotal = cart.reduce((sum, i) => sum + (i.price * i.quantity), 0);
    const netTotal = Math.max(0, subtotal - discountAmount);
    const balanceToPay = Math.max(0, netTotal - depositAmount);
    const rText = document.getElementById('receivedText');
    if (receivedAmount > 0) {
        rText.textContent = "‡∏ø " + receivedAmount.toLocaleString();
    } else {
        rText.textContent = "‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô";
    }
    const cDisp = document.getElementById('changeDisplay');
    if (receivedAmount >= balanceToPay && receivedAmount > 0) {
        cDisp.classList.remove('hidden');
        document.getElementById('changeAmount').textContent = `${(receivedAmount - balanceToPay).toLocaleString()}.-`;
    } else { cDisp.classList.add('hidden'); }
}

function switchTab(tab) {
    playSound('click');
    const sBtn = document.getElementById('saleTab'), hBtn = document.getElementById('historyTab');
    const sView = document.getElementById('saleForm'), hView = document.getElementById('historyView');
    if (tab === 'sale') {
        sBtn.classList.add('tab-active'); hBtn.classList.remove('tab-active');
        sView.classList.remove('hidden'); hView.classList.add('hidden');
    } else {
        hBtn.classList.add('tab-active'); sBtn.classList.remove('tab-active');
        sView.classList.add('hidden'); hView.classList.remove('hidden');
        renderHistory();
    }
}
document.getElementById('saleTab').onclick = () => switchTab('sale');
document.getElementById('historyTab').onclick = () => switchTab('history');

document.getElementById('discountBtn').onclick = () => showGeneralNumpad('Discount (‡∏ø)', discountAmount, (v) => { discountAmount = parseFloat(v); updateCartDisplay(); });
document.getElementById('depositBtn').onclick = () => showGeneralNumpad('Deposit (‡∏ø)', depositAmount, (v) => { depositAmount = parseFloat(v); updateCartDisplay(); });
document.getElementById('receivedBtn').onclick = () => showGeneralNumpad('Received (‡∏ø)', receivedAmount, (v) => { receivedAmount = parseFloat(v); calculateChange(); });
document.getElementById('clearCart').onclick = () => { if(confirm('‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) { playSound('trash'); cart = []; updateCartDisplay(); } };

document.getElementById('resetDailyData').onclick = () => {
    if(confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ?')) {
        playSound('trash'); salesData = []; localStorage.setItem('salesData', JSON.stringify(salesData));
        renderHistory(); updateReceiptNoDisplay();
    }
};

document.getElementById('submitOrder').onclick = async () => {
    if (cart.length === 0) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤!');
    const subtotal = cart.reduce((sum, i) => sum + (i.price * i.quantity), 0);
    const netTotal = Math.max(0, subtotal - discountAmount);
    const balanceToPay = Math.max(0, netTotal - depositAmount);
    if (receivedAmount < balanceToPay) return alert('‡∏¢‡∏≠‡∏î‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠!');
    
    playSound('success');
    const record = {
        id: Date.now(), receiptNo: updateReceiptNoDisplay(), items: [...cart],
        subtotal, discount: discountAmount, deposit: depositAmount, total: netTotal,
        received: receivedAmount, change: receivedAmount - balanceToPay,
        timestamp: new Date().toISOString(), date: new Date().toDateString()
    };
    salesData.push(record);
    localStorage.setItem('salesData', JSON.stringify(salesData));
    if (GOOGLE_SCRIPT_URL) {
        const payload = { ...record, itemsString: record.items.map(i => `${i.product}(${i.quantity})`).join(', ') };
        fetch(GOOGLE_SCRIPT_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(payload) });
    }
    printPC(record); cart = []; discountAmount = 0; depositAmount = 0; receivedAmount = 0;
    updateCartDisplay(); updateReceiptNoDisplay();
};

function renderHistory() {
    const historyList = document.getElementById('salesHistory'), noHistory = document.getElementById('noHistory');
    if (salesData.length === 0) {
        historyList.innerHTML = ''; noHistory.classList.remove('hidden');
    } else {
        noHistory.classList.add('hidden');
        historyList.innerHTML = [...salesData].reverse().map(s => `
            <div class="bg-white p-6 rounded-3xl border border-slate-100 shadow-sm relative group overflow-hidden">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <div class="text-[10px] font-black text-indigo-600 mb-1 uppercase tracking-widest">${s.receiptNo}</div>
                        <div class="text-[10px] text-slate-400 font-bold">${new Date(s.timestamp).toLocaleTimeString('th-TH')}</div>
                    </div>
                    <div class="text-xl font-black text-slate-900">${s.total.toLocaleString()}.-</div>
                </div>
                <div class="text-[10px] text-slate-500 space-y-1 mb-5 bg-slate-50 p-4 rounded-2xl border border-slate-100">
                    ${s.items.map(i => `<div class="flex justify-between"><span>${i.product}</span><b>x${i.quantity}</b></div>`).join('')}
                </div>
                <button onclick='printPC(${JSON.stringify(s)})' class="w-full bg-slate-900 hover:bg-indigo-600 text-white py-3 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all">üñ®Ô∏è Reprint Bill</button>
            </div>
        `).join('');
    }
}

function printPC(record) {
    const container = document.getElementById('receipt-for-pc');
    container.innerHTML = `
        <div style="text-align:center; font-family:'Sarabun'; width:200px; padding:10px; color:black;">
            <b style="font-size:12pt;">‡∏´‡∏°‡∏µ‡πà‡πÑ‡∏Å‡πà‡∏â‡∏µ‡∏Å ‡∏ä‡∏¥‡∏Å‡∏ä‡∏¥‡∏Å‡πÄ‡∏Å‡πâ‡∏ô‡∏â‡∏µ‡∏Å</b><br>
            <span style="font-size:8pt;">‡∏™‡∏≤‡∏Ç‡∏≤ ‡πÅ‡∏°‡πà‡πÇ‡∏à‡πâ‡∏ã‡∏≠‡∏¢ 9 </span><hr style="border-top:1px dashed #000; margin:8px 0;">
            <div style="font-size:8pt; text-align:left;">
                ID: ${record.receiptNo}<br>Date: ${new Date(record.timestamp).toLocaleString('th-TH')}
            </div><hr style="border-top:1px dashed #000; margin:5px 0;">
            <table style="width:100%; font-size:8pt; border-collapse: collapse;">
                ${record.items.map(i => `<tr><td>${i.quantity} x ${i.product}</td><td style="text-align:right;">${(i.price * i.quantity)}</td></tr>`).join('')}
            </table><hr style="border-top:1px dashed #000; margin:5px 0;">
            <table style="width:100%; font-size:8pt; font-weight:bold;">
                <tr style="font-size:11pt;"><td>TOTAL:</td><td style="text-align:right;">${record.total}.-</td></tr>
                <tr style="font-weight:normal;"><td>Cash:</td><td style="text-align:right;">${record.received}</td></tr>
                <tr style="font-weight:normal;"><td>Change:</td><td style="text-align:right;">${record.change}</td></tr>
            </table>
            <hr style="border: none; border-top: 1px dashed #000; margin: 5px 0;">
            <p style="font-size: 8pt; text-align: center; margin: 0;">‡πÇ‡∏ó‡∏£: 093-145-0736</p>
            <p style="font-size: 8pt; text-align: center; margin: 0;">Facebook: ‡∏ä‡∏¥‡∏Å‡∏ä‡∏¥‡∏Å‡πÄ‡∏Å‡πâ‡∏ô‡∏â‡∏µ‡∏Å</p>
            <div style="text-align: center; font-size: 8pt; color: #555;">
                <img src="https://qr-official.line.me/gs/M_830jgqvb_BW.png?oat_content=qr" alt="QR Code" style="display: block; margin: 5px auto; width: 60px; height: 60px;">
                <p style="margin: 4px 0 0 0;">LINE: @CCKC</p>
            </div>
            <p style="font-size: 10pt; text-align: center; margin: 10px 0 0 0;">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</p>
        </div>
    `;
    window.print();
}

function showGeneralNumpad(title, currentVal, onConfirm) {
    playSound('click');
    const modal = document.createElement('div');
    modal.className = 'fixed inset-0 bg-white/80 backdrop-blur-md flex items-center justify-center z-[100] p-6 no-print';
    modal.innerHTML = `
        <div class="bg-white rounded-[3.5rem] p-8 w-full max-w-sm border border-slate-200 shadow-2xl animate-in zoom-in-95">
            <h3 class="text-slate-400 text-center mb-6 font-black uppercase tracking-widest text-[10px]">${title}</h3>
            <div id="numpadDisplay" class="text-6xl font-black text-slate-900 text-right mb-8 pr-2 tracking-tighter">0</div>
            <div class="grid grid-cols-3 gap-3 mb-8">
                ${[1,2,3,4,5,6,7,8,9].map(n => `<button class="p-6 bg-slate-50 text-slate-800 text-3xl rounded-3xl font-black hover:bg-indigo-600 hover:text-white transition-all" onclick="window.padInput('${n}')">${n}</button>`).join('')}
                <button class="p-6 bg-red-50 text-red-500 text-2xl rounded-3xl font-black" onclick="window.padClear()">C</button>
                <button class="p-6 bg-slate-50 text-slate-800 text-3xl rounded-3xl font-black" onclick="window.padInput('0')">0</button>
                <button class="p-6 bg-slate-50 text-slate-400 text-2xl rounded-3xl font-black" onclick="window.padDel()">‚Üê</button>
            </div>
            <div class="flex gap-4">
                <button onclick="window.closePad(false)" class="flex-1 py-4 text-slate-400 font-bold uppercase text-[10px]">Cancel</button>
                <button onclick="window.closePad(true)" class="flex-[2] bg-indigo-600 text-white font-black text-xl rounded-2xl shadow-lg">Confirm</button>
            </div>
        </div>
    `;
    document.body.appendChild(modal);
    let str = currentVal.toString() === '0' ? '' : currentVal.toString();
    const display = modal.querySelector('#numpadDisplay');
    display.textContent = str || '0';
    window.padInput = (v) => { if(str.length < 9) str += v; display.textContent = str || '0'; };
    window.padDel = () => { str = str.slice(0, -1); display.textContent = str || '0'; };
    window.padClear = () => { str = ''; display.textContent = '0'; };
    window.closePad = (confirm) => { if(confirm) { onConfirm(str || '0'); } modal.remove(); };
}
</script>
</body>
</html>
